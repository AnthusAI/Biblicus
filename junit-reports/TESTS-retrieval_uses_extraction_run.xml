<testsuite name="retrieval_uses_extraction_run.Retrieval can use extracted text artifacts" tests="9" errors="0" failures="0" skipped="0" time="0.286144" timestamp="2026-01-29T13:53:56.205029" hostname="JW2TF3YWMJ"><testcase classname="retrieval_uses_extraction_run.Retrieval can use extracted text artifacts" name="Query finds text extracted from a Portable Document Format item" status="passed" time="0.022936"><system-out>
<![CDATA[
@scenario.begin
  Scenario: Query finds text extracted from a Portable Document Format item
    Given I initialized a corpus at "corpus" ... passed in 0.003s
    And a Portable Document Format file "hello.pdf" exists with text "Portable Document Format retrieval" ... passed in 0.000s
    When I ingest the file "hello.pdf" into corpus "corpus" ... passed in 0.004s
    And I build a "pdf-text" extraction run in corpus "corpus" ... passed in 0.005s
    And I build a "sqlite-full-text-search" retrieval run in corpus "corpus" using the latest extraction run and config: ... passed in 0.007s
      | key                | value |
      | chunk_size         | 200   |
      | chunk_overlap      | 50    |
      | snippet_characters | 120   |
    And I query with the latest run for "Portable Document Format retrieval" and budget: ... passed in 0.003s
      | key                  | value |
      | max_total_items      | 5     |
      | max_total_characters | 10000 |
      | max_items_per_source | 5     |
    Then the query evidence includes the last ingested item identifier ... passed in 0.000s

@scenario.end
--------------------------------------------------------------------------------
]]>
</system-out></testcase><testcase classname="retrieval_uses_extraction_run.Retrieval can use extracted text artifacts" name="Query finds text that exists only in extracted artifacts" status="passed" time="0.02423"><system-out>
<![CDATA[
@scenario.begin
  Scenario: Query finds text that exists only in extracted artifacts
    Given I initialized a corpus at "corpus" ... passed in 0.004s
    And a binary file "image.png" exists ... passed in 0.000s
    When I ingest the file "image.png" with tags "unique extracted phrase" into corpus "corpus" ... passed in 0.006s
    And I build a "metadata-text" extraction run in corpus "corpus" ... passed in 0.004s
    And I build a "sqlite-full-text-search" retrieval run in corpus "corpus" using the latest extraction run and config: ... passed in 0.007s
      | key                | value |
      | chunk_size         | 200   |
      | chunk_overlap      | 50    |
      | snippet_characters | 120   |
    And I query with the latest run for "unique extracted phrase" and budget: ... passed in 0.003s
      | key                  | value |
      | max_total_items      | 5     |
      | max_total_characters | 10000 |
      | max_items_per_source | 5     |
    Then the query evidence includes the last ingested item identifier ... passed in 0.000s

@scenario.end
--------------------------------------------------------------------------------
]]>
</system-out></testcase><testcase classname="retrieval_uses_extraction_run.Retrieval can use extracted text artifacts" name="Retrieval build fails when the extraction run does not exist" status="passed" time="0.012033"><system-out>
<![CDATA[
@scenario.begin
  Scenario: Retrieval build fails when the extraction run does not exist
    Given I initialized a corpus at "corpus" ... passed in 0.004s
    And a binary file "image.png" exists ... passed in 0.000s
    When I ingest the file "image.png" into corpus "corpus" ... passed in 0.004s
    And I attempt to build a "sqlite-full-text-search" retrieval run in corpus "corpus" with extraction run "metadata-text:missing" ... passed in 0.004s
    Then the command fails with exit code 2 ... passed in 0.000s
    And standard error includes "Missing extraction run" ... passed in 0.000s

@scenario.end
--------------------------------------------------------------------------------
]]>
</system-out></testcase><testcase classname="retrieval_uses_extraction_run.Retrieval can use extracted text artifacts" name="Scan backend can query using extracted text artifacts" status="passed" time="0.024404"><system-out>
<![CDATA[
@scenario.begin
  Scenario: Scan backend can query using extracted text artifacts
    Given I initialized a corpus at "corpus" ... passed in 0.006s
    And a binary file "image.png" exists ... passed in 0.000s
    When I ingest the file "image.png" with tags "scan extracted phrase" into corpus "corpus" ... passed in 0.007s
    And I build a "metadata-text" extraction run in corpus "corpus" ... passed in 0.004s
    And I build a "scan" retrieval run in corpus "corpus" using the latest extraction run and config: ... passed in 0.004s
      | key                | value |
      | snippet_characters | 120   |
    And I query with the latest run for "scan extracted phrase" and budget: ... passed in 0.003s
      | key                  | value |
      | max_total_items      | 5     |
      | max_total_characters | 10000 |
      | max_items_per_source | 5     |
    Then the query evidence includes the last ingested item identifier ... passed in 0.000s

@scenario.end
--------------------------------------------------------------------------------
]]>
</system-out></testcase><testcase classname="retrieval_uses_extraction_run.Retrieval can use extracted text artifacts" name="Invalid extraction run reference is rejected" status="passed" time="0.00669"><system-out>
<![CDATA[
@scenario.begin
  Scenario: Invalid extraction run reference is rejected
    Given I initialized a corpus at "corpus" ... passed in 0.003s
    When I attempt to build a "sqlite-full-text-search" retrieval run in corpus "corpus" with extraction run "invalid" ... passed in 0.003s
    Then the command fails with exit code 2 ... passed in 0.000s
    And standard error includes "Extraction run reference must be extractor_id:run_id" ... passed in 0.000s

@scenario.end
--------------------------------------------------------------------------------
]]>
</system-out></testcase><testcase classname="retrieval_uses_extraction_run.Retrieval can use extracted text artifacts" name="Extraction run reference requires non-empty parts" status="passed" time="0.006927"><system-out>
<![CDATA[
@scenario.begin
  Scenario: Extraction run reference requires non-empty parts
    Given I initialized a corpus at "corpus" ... passed in 0.004s
    When I attempt to build a "sqlite-full-text-search" retrieval run in corpus "corpus" with extraction run "x:" ... passed in 0.003s
    Then the command fails with exit code 2 ... passed in 0.000s
    And standard error includes "non-empty parts" ... passed in 0.000s

@scenario.end
--------------------------------------------------------------------------------
]]>
</system-out></testcase><testcase classname="retrieval_uses_extraction_run.Retrieval can use extracted text artifacts" name="Scan backend rejects a missing extraction run" status="passed" time="0.007874"><system-out>
<![CDATA[
@scenario.begin
  Scenario: Scan backend rejects a missing extraction run
    Given I initialized a corpus at "corpus" ... passed in 0.005s
    When I attempt to build a "scan" retrieval run in corpus "corpus" with extraction run "metadata-text:missing" ... passed in 0.003s
    Then the command fails with exit code 2 ... passed in 0.000s
    And standard error includes "Missing extraction run" ... passed in 0.000s

@scenario.end
--------------------------------------------------------------------------------
]]>
</system-out></testcase><testcase classname="retrieval_uses_extraction_run.Retrieval can use extracted text artifacts" name="Skipped extraction artifacts do not produce evidence" status="passed" time="0.136646"><system-out>
<![CDATA[
@scenario.begin
  Scenario: Skipped extraction artifacts do not produce evidence
    Given I initialized a corpus at "corpus" ... passed in 0.004s
    And a binary file "image.png" exists ... passed in 0.000s
    When I ingest the file "image.png" into corpus "corpus" ... passed in 0.004s
    And I build a "pass-through-text" extraction run in corpus "corpus" ... passed in 0.027s
    And I build a "scan" retrieval run in corpus "corpus" using the latest extraction run and config: ... passed in 0.036s
      | key                | value |
      | snippet_characters | 120   |
    And I query with the latest run for "anything" and budget: ... passed in 0.064s
      | key                  | value |
      | max_total_items      | 5     |
      | max_total_characters | 10000 |
      | max_items_per_source | 5     |
    Then the query evidence count is 0 ... passed in 0.000s

@scenario.end
--------------------------------------------------------------------------------
]]>
</system-out></testcase><testcase classname="retrieval_uses_extraction_run.Retrieval can use extracted text artifacts" name="SQLite full-text search ignores items with no extracted text artifacts" status="passed" time="0.044404"><system-out>
<![CDATA[
@scenario.begin
  Scenario: SQLite full-text search ignores items with no extracted text artifacts
    Given I initialized a corpus at "corpus" ... passed in 0.005s
    And a binary file "image.png" exists ... passed in 0.000s
    When I ingest the file "image.png" into corpus "corpus" ... passed in 0.007s
    And I build a "pass-through-text" extraction run in corpus "corpus" ... passed in 0.006s
    And I build a "sqlite-full-text-search" retrieval run in corpus "corpus" using the latest extraction run and config: ... passed in 0.015s
      | key                | value |
      | chunk_size         | 200   |
      | chunk_overlap      | 50    |
      | snippet_characters | 120   |
    And I query with the latest run for "anything" and budget: ... passed in 0.010s
      | key                  | value |
      | max_total_items      | 5     |
      | max_total_characters | 10000 |
      | max_items_per_source | 5     |
    Then the query evidence count is 0 ... passed in 0.000s

@scenario.end
--------------------------------------------------------------------------------
]]>
</system-out></testcase></testsuite>